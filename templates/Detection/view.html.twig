{# ressources/Detection/index.html.twig #}

{% extends "base.html.twig" %}

{% block title %}
    Scan detail - {{ parent() }}
{% endblock %}

{% block vuln_body %}
    <table id="listDetectionDetail" class="display nowrap" cellspacing="0" width="100%">
        <thead>
        <tr>
            <th>Vulnerability</th>
            <th>Asset</th>
            <th>Detection Date</th>
            <th>Port</th>
            <th>CVSS</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>

        <!--début de la boucle-->
        {% for vulnerability in vulnerabilities %}
            <tr>
                <td>{% if (vulnerability.vulnerability.description|length < 100) %}
                        {{ vulnerability.vulnerability.description }}
                    {% else %}
                        {{ vulnerability.vulnerability.description[:100]}}...
                    {% endif %}</td>
                <td>{{ vulnerability.asset.ip }}</td>
                <td style="text-indent: 0.5em;">{{ vulnerability.date_created | date("Y/m/d") }}</td>
                <td>{{ vulnerability.port }}</td>
                {% if vulnerability.vulnerability.cvss is not null %}
                    <td>{{ vulnerability.vulnerability.cvss }}</td>
                {% else %}
                    <td>0</td>
                {% endif %}
                <td>{{ vulnerability.status.name }}</td>
                <td>
                    <a href="{{ path('app_vulnerabilitydetected_edit', {'id': vulnerability.id}) }}" class="bt-table" title="Modifier" data-hover="tooltip"><span class="glyphicon glyphicon-pencil" style="color: #6b6b6b;"></span></a>
                    <a href="{{ path('app_vulnerability_view', {'id': vulnerability.vulnerability.id}) }}" class="bt-table" title="Plus de détails" data-hover="tooltip"><span class="glyphicon glyphicon-search" style="color: #6a6a6a;"></span></a>
                </td>
            </tr>
            <!--fin de la boucle-->
        {% endfor %}

        </tbody>
    </table>

{% endblock %}
